# 基于图注意力网络的无人机语义通信资源分配

---

## 第1页：标题页

**基于图注意力网络的无人机语义通信资源分配**

Multi-Agent Reinforcement Learning with Graph Attention Networks for UAV Semantic Communication

汇报人：[姓名]  
日期：[日期]

---

## 第2页：研究背景

### 问题场景
- 6个UAV在室内环境中协同工作
- 需要同时优化：RB选择、功率控制、语义压缩比
- 目标：最大化语义能量效率（Semantic-EE）

### 核心挑战
1. **多智能体协作**：UAV间存在干扰和竞争
2. **动态环境**：信道和位置快速变化
3. **语义通信优化**：压缩比与准确度权衡

---

## 第3页：系统架构

```
训练主循环 (main_PPO_AC.py)
    ↓
PPO智能体 (PPO_brain_AC.py)
  ├─ GAT编码器（图注意力网络）
  ├─ Actor网络（策略：Power, RB, ρ）
  └─ Critic网络（值函数）
    ↓
仿真环境 (Environment_marl_indoor.py)
  ├─ UAV移动模型
  ├─ A2G信道模型
  └─ 语义通信计算
```

---

## 第4页：GAT编码器设计

### 节点特征（25维）
- CSI快衰落：10维
- CSI慢衰落：10维
- 位置信息：3维 (x, y, z)
- 成功标志：1维
- Episode进度：1维

### 邻接矩阵
- 基于通信距离（500m）
- 动态更新（UAV移动）

### 关键技术
- **多头注意力**：4个头，学习不同关系
- **残差连接**：提升训练稳定性
- **多层GAT**：3层编码器

---

## 第5页：MAPPO算法

### PPO损失函数
```
L = L_clip_power + L_clip_RB + L_clip_rho - c1·L_vf + c2·S
```

### 动作空间
| 动作 | 分布类型 | 范围 |
|------|---------|------|
| Power | 正态分布 | [-bound, +bound] |
| RB | 分类分布 | [0, 9] |
| ρ | Beta分布 | [0, 1] |

### GAE优势估计
- 为每个agent单独计算
- 支持2D输入 `[T, n_veh]`

---

## 第6页：语义通信模型

### 语义准确度
```
A(ρ, SINR) = A_max · (1 - exp(-β·ρ)) · log(1 + SINR) / log(1 + max_SINR)
```

### 语义能量效率
```
Semantic-EE = A(ρ, SINR) / Total_Power
```

### 优化目标
- 最大化语义准确度
- 最小化功率消耗
- 平衡压缩比与准确度

---

## 第7页：关键技术实现

### 1. GAT批处理
- 使用`tf.map_fn`处理批次中的每个图
- 支持动态批次大小

### 2. 节点选择机制
- 每个agent使用自己的节点输出
- 不取mean，避免信息丢失

### 3. 数值稳定性
- 梯度裁剪（0.5）
- 值函数裁剪（-50, 50）
- NaN检测与替换

### 4. Reward归一化
- 检查std，避免除零错误
- 保持原始值（如果std=0）

---

## 第8页：训练流程

```
1. 初始化环境（6个UAV随机位置）
   ↓
2. 收集轨迹数据（并行多个episode）
   ↓
3. 计算GAE优势
   ↓
4. 采样批次数据
   ↓
5. 训练每个agent（GAT编码 + PPO损失）
   ↓
6. 联邦学习聚合（简单平均）
   ↓
7. 更新old网络参数
   ↓
8. 重复步骤2-7
```

---

## 第9页：实验结果

### 环境配置
- UAV数量：6
- RB数量：10
- 环境大小：25m × 25m
- 学习率：1e-6

### 关键修复
1. ✅ GAE计算修复（支持2D输入）
2. ✅ Reward归一化修复（避免除零）
3. ✅ 节点选择机制（不取mean）
4. ✅ 数值稳定性（梯度裁剪等）

### 当前状态
- ✅ GAT编码器实现完成
- ✅ 多动作头实现完成
- ⚠️ Actor参数NaN问题（调试中）

---

## 第10页：工作总结

### 已完成
1. **架构设计**：GAT + MAPPO集成
2. **算法实现**：多层GAT、多动作头、GAE
3. **问题修复**：GAE、归一化、节点选择

### 技术亮点
- 图结构建模UAV关系
- 注意力机制学习重要邻居
- 残差连接提升稳定性
- 语义通信优化

### 下一步
1. 调试Actor网络NaN问题
2. 性能优化与超参数调整
3. 实验验证（GAT vs MLP）
4. 功能扩展（边特征、动态图）

---

## 第11页：预期效果

### 性能提升
- **协作能力**：GAT帮助学习协作策略
- **收敛速度**：图结构信息加速学习
- **通信效率**：语义通信优化提升效率
- **泛化能力**：支持不同网络拓扑

### 创新点
1. 首次将GAT应用于UAV语义通信资源分配
2. 多动作头设计（Power + RB + ρ）
3. 节点级值函数估计
4. 残差连接提升稳定性

---

## 第12页：谢谢！

**问题与讨论**

---

## 附录：代码结构

```
GAT_RA/
├── main_PPO_AC.py          # 训练主循环
├── PPO_brain_AC.py         # PPO智能体（GAT+MAPPO）
├── Environment_marl_indoor.py  # 仿真环境
├── arguments.py            # 参数配置
└── logs/tensorboard/       # 训练日志
```

**主要文件**：
- `PPO_brain_AC.py` (1314行)：GAT编码器、Actor/Critic网络
- `main_PPO_AC.py` (398行)：训练循环、数据收集
- `Environment_marl_indoor.py` (896行)：环境仿真、奖励计算

